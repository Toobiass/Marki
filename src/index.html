<!DOCTYPE html>
<html>

<head>
    <style>
        ::-webkit-scrollbar {
            width: 10px;
            background-color: transparent;
        }

        ::-webkit-scrollbar-track {
            background-color: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background-color: rgba(121, 121, 121, 0.2);
            border-radius: 0px;
            border: 2px solid transparent;
            background-clip: content-box;
        }

        .pane:hover::-webkit-scrollbar-thumb {
            background-color: rgba(121, 121, 121, 0.4);
        }

        ::-webkit-scrollbar-thumb:active {
            background-color: rgba(121, 121, 121, 0.7);
        }

        .preview-pane::-webkit-scrollbar {
            display: none;
            /* Versteckt den Scrollbalken in Chrome, Safari und Edge */
            width: 0;
            /* Zusätzliche Absicherung */
        }

        ::-webkit-scrollbar-corner {
            background: transparent;
        }

        :root {
            --bg-dark: #121212;
            --bg-editor: #1e1e1e;
            --text-main: #d4d4d4;
            --accent: #007acc;
            --border: #333333;
        }

        body {
            margin: 0;
            padding: 0;
            background: var(--bg-dark);
            color: var(--text-main);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: 'Segoe UI', sans-serif;
        }

        .main-container {
            display: flex;
            width: 100%;
            height: 100%;
        }

        .pane {
            flex: 1;
            width: 50%;
            max-width: 50%;
            height: 100vh;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .editor-pane {
            background: var(--bg-editor);
            border-right: 1px solid var(--border);
        }

        .preview-pane {
            background: var(--bg-editor);
            overflow-y: auto;
        }

        textarea {
            width: 100%;
            height: 100%;
            background: transparent;
            color: var(--text-main);
            border: none;
            padding: 40px;
            font-size: 16px;
            font-family: 'Consolas', monospace;
            resize: none;
            outline: none;
            box-sizing: border-box;
            overflow-y: auto;
        }

        #preview {
            padding: 40px;
            line-height: 1.6;
            word-wrap: break-word;
            white-space: pre-wrap;
        }
    </style>
</head>

<body>
    <div class="main-container">
        <div class="pane editor-pane">
            <textarea id="editor" placeholder="Schreib hier..."></textarea>
        </div>

        <div class="pane preview-pane" id="preview-container">
            <div id="preview"></div>
        </div>
    </div>

    <script>
        const editor = document.getElementById('editor');
        const preview = document.getElementById('preview');
        const previewContainer = document.getElementById('preview-container');

        editor.addEventListener('input', () => {
            preview.innerText = editor.value;
        });

        let isSyncing = false;

        const syncScroll = (source, target) => {
            if (isSyncing) {
                isSyncing = false;
                return;
            }
            isSyncing = true;

            const percentage = source.scrollTop / (source.scrollHeight - source.clientHeight);
            target.scrollTop = percentage * (target.scrollHeight - target.clientHeight);
        };

        editor.addEventListener('scroll', () => syncScroll(editor, previewContainer));
        previewContainer.addEventListener('scroll', () => syncScroll(previewContainer, editor));

        document.addEventListener('keydown', async (e) => {
            if (e.ctrlKey && e.key.toLowerCase() === 'p') {
                e.preventDefault();
                const filePath = await window.electronAPI.selectFolder();
                if (filePath) {
                    localStorage.setItem('marki-path', filePath);
                    window.electronAPI.log("Erfolgreich gespeichert!");
                }
            }
        });

        window.onload = () => {
            const savedPath = localStorage.getItem('marki-path');
            if (savedPath) {
                window.electronAPI.log("Willkommen zurück! Pfad ist: " + savedPath);
            }
        };
    </script>
</body>

</html>